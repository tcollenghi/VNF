@model VNF.Portal.Models.PortariaModel

@{
    string strClassTable = (Model != null && Model.pasta != null && Model.pasta.NOTAS != null && Model.pasta.NOTAS.Count() > 0) ? "" : "hide";
}

<style>
    .txtPasta {
        height: 170px;
        font-size: 60pt;
        text-align: center;
        font-weight: bold;
    }

    .padding0 {
        padding: 0px !important;
    }

    .margin0 {
        margin: 0px !important;
    }

    .line-height0 {
        line-height: 0% !important;
    }

    .center {
        text-align: center !important;
    }
</style>

<div id="divDetalhesPasta" class="modal-content">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Fechar</span></button>
        @if (Model == null || Model.pasta == null)
        {
            <h4>Nova Pasta</h4>
        }
        else
        {
            if (string.IsNullOrEmpty(Model.pasta.HORCHE))
            {
                <h4>Nova Pasta</h4>
            }
            else
            {
                <h4>Consultar Pasta</h4>
                <input id="txtDataChegada" type="hidden" value="@Model.pasta.HORCHE" />
            }
        }
    </div>
    <div class="modal-body">

        <div class="row">

            <div class="col-md-2">
                <p>Pasta</p>
                <p>
                    @if (Model == null || Model.pasta == null)
                    {
                        @Html.TextBox("txtPasta", "", new { id = "txtPasta", maxlength = "2", @class = "form-control txtPasta txt-color-red", onkeypress = "return onlyInt(event)" })
                    }
                    else
                    {
                        @Html.TextBox("txtPasta", Model.pasta.IDPASTA, new { id = "txtPasta", maxlength = "2", @class = "form-control txtPasta txt-color-red", disabled = "disabled", onkeypress = "return onlyInt(event)" })
                    }
                </p>
            </div>

            <div class="col-md-10">

                <div class="row">
                    <div class="col-md-6">
                        <p>Setor</p>
                        <p>
                            @if (Model == null || Model.pasta == null)
                            {
                                @Html.TextBox("txtSetor", "", new { id = "txtSetor", maxlength = "255", @class = "form-control" })
                            }
                            else
                            {
                                if (string.IsNullOrEmpty(Model.pasta.HORENT))
                                {
                                    @Html.TextBox("txtSetor", Model.pasta.SETOR, new { id = "txtSetor", maxlength = "255", @class = "form-control" })

                                }
                                else
                                {
                                    @Html.TextBox("txtSetor", Model.pasta.SETOR, new { id = "txtSetor", maxlength = "255", @class = "form-control", disabled = "disabled" })
                                }
                            }
                        </p>
                    </div>
                    <div class="col-md-6">
                        <p>Transportadora</p>
                        <p>
                            @if (Model == null || Model.pasta == null)
                            {
                                @Html.TextBox("txtTransportadora", "", new { id = "txtTransportadora", maxlength = "255", @class = "form-control" })
                            }
                            else
                            {
                                if (string.IsNullOrEmpty(Model.pasta.HORENT))
                                {
                                    @Html.TextBox("txtTransportadora", Model.pasta.NOMTRA, new { id = "txtTransportadora", maxlength = "255", @class = "form-control" })
                                }
                                else
                                {
                                    @Html.TextBox("txtTransportadora", Model.pasta.NOMTRA, new { id = "txtTransportadora", maxlength = "255", @class = "form-control", disabled = "disabled" })
                                }
                            }
                        </p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <p>Motorista</p>
                        <p>
                            @if (Model == null || Model.pasta == null)
                            {
                                @Html.TextBox("txtMotorista", "", new { id = "txtMotorista", maxlength = "255", @class = "form-control" })
                            }
                            else
                            {
                                if (string.IsNullOrEmpty(Model.pasta.HORENT))
                                {
                                    @Html.TextBox("txtMotorista", Model.pasta.NOMMOT, new { id = "txtMotorista", maxlength = "255", @class = "form-control" })
                                }
                                else
                                {
                                    @Html.TextBox("txtMotorista", Model.pasta.NOMMOT, new { id = "txtMotorista", maxlength = "255", @class = "form-control", disabled = "disabled" })
                                }
                            }
                        </p>
                    </div>
                    <div class="col-md-6">
                        <p>Placa</p>
                        <p>
                            @if (Model == null || Model.pasta == null)
                            {
                                @Html.TextBox("txtPlaca", "", new { id = "txtPlaca", @*maxlength = "10",*@ @class = "form-control"@*, @onfocus = "mascaraPlaca();"*@})@*' Marcio Spinosa - 29/11/2018 - CR00009165*@}
                            else
                            {
                                if (string.IsNullOrEmpty(Model.pasta.HORENT))
                                {
                                    @Html.TextBox("txtPlaca", Model.pasta.PLACA, new { id = "txtPlaca", @*maxlength = "10",*@ @class = "form-control"@*, @onfocus = "mascaraPlaca();"*@})@*' Marcio Spinosa - 29/11/2018 - CR00009165*@}
                                else
                                {
                                    @Html.TextBox("txtPlaca", Model.pasta.PLACA, new { id = "txtPlaca", @*maxlength = "10",*@ @class = "form-control", disabled = "disabled" })
                                }
                            }
                        </p>
                    </div>
                </div>

                <div class="row" id="divDanfeVerifica">
                    <div class="col-md-11">
                        <p>DANFE</p>
                        <p>
                            @if (Model == null || Model.pasta == null)
                            {
                                @Html.TextBox("txtDanfe", "", new { id = "txtDanfe", maxlength = "255", @class = "form-control pulaComEnter", onkeypress = "return PulaComEnter(event)" })
                            }
                            else
                            {
                                if (string.IsNullOrEmpty(Model.pasta.HORENT))
                                {
                                    @Html.TextBox("txtDanfe", "", new { id = "txtDanfe", maxlength = "255", @class = "form-control pulaComEnter", onkeypress = "return PulaComEnter(event)" })
                                }
                                else
                                {
                                    @Html.TextBox("txtDanfe", "", new { id = "txtDanfe", maxlength = "255", @class = "form-control pulaComEnter", disabled = "disabled", onkeypress = "return PulaComEnter(event)" })
                                }
                            }
                        </p>

                    </div>
                    <div class="col-md-1" style="margin-top: 27px;">
                        <p class="right">
                            @if (Model == null || Model.pasta == null)
                            {
                                <a class="btn btn-primary" onclick="VerificaSeExcluilDanfe();"><i class="fa fa-search"></i><span class="text-btn"></span></a>
                            }
                            else
                            {
                                if (string.IsNullOrEmpty(Model.pasta.HORENT))
                                {
                                    <a class="btn btn-primary" onclick="VerificaSeExcluilDanfe();"><i class="fa fa-search"></i><span class="text-btn"></span></a>
                                }
                                else
                                {
                                    <a class="btn btn-primary" onclick="VerificaSeExcluilDanfe();"><i class="fa fa-search"></i><span class="text-btn"></span></a>
                                }
                            }
                        </p>
                    </div>
                </div>

            </div>

        </div>

        <br />
        <div class="scroll-y" style="max-height:150px;overflow:auto">
            <table id="dttNotas" datatables_fixedheader="top" datatables_fixedheader_offsettop="60" class="table table-striped table-bordered table-hover table-click @strClassTable" width="95%">
                <thead>
                    <tr>
                        <th width="5%">Prioridade</th>
                        <th width="45%" class="chave">Chave de Acesso</th>
                        <th width="10%">DOC-e</th>
                        <th width="30%">Fornecedor</th>
                        <th width="10%">Status</th>
                        @if ((Model == null || Model.pasta == null) || (string.IsNullOrEmpty(Model.pasta.HORENT)))
                        {
                            <th></th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.pasta != null && Model.pasta.NOTAS != null)
                    {
                        int linha = 1;
                        string strFornecedor = "";

                        foreach (VNF.Portal.Models.NotaModel item in Model.pasta.NOTAS)
                        {
                            strFornecedor = item.Fornecedor.Length <= 25 ? item.Fornecedor : item.Fornecedor.Substring(0, 25) + "...";

                            <tr id="@item.ChaveAcesso">
                                @if (item.PrioridadeAlta == "SIM")
                                {
                                    <td class="center"><h5 class="padding0 margin0 line-height0" title="Alta"><i class="fa fa-arrow-circle-up txt-color-red"></i></h5></td>
                                }
                                else if (item.PrioridadeAlta == "NÃO")
                                {
                                    <td class="center"><h5 class="padding0 margin0 line-height0" title="Normal"><i class="fa fa-arrow-circle-down txt-color-green"></i></h5></td>
                                }
                                <td class="chave">@item.ChaveAcesso</td>
                                <td>@item.DOCe</td>
                                <td>@strFornecedor</td>
                                <td>@item.Status</td>
                                @if ((Model == null || Model.pasta == null) || (string.IsNullOrEmpty(Model.pasta.HORENT)))
                                {
                                    <td><h5 class="padding0 margin0 line-height0" title="remover documento"><i class="fa fa-times txt-color-red cursor-pointer" onclick="RemoveLinha('@item.ChaveAcesso');"></i></h5></td>
                                }
                            </tr>

                            linha = linha + 1;
                        }
                    }
                </tbody>
                <tfoot class="hide">
                    <tr>
                        <th colspan="9">
                            <div class="loading-grid">
                                <img alt="loading" class="left" id="imgLoadingProductions" name="imgLoadingProductions" src="/images/loading-small_white.gif" title="loading"><h4 class="left">carregando...</h4>
                            </div>
                        </th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <div class="modal-footer">
        <a class="btn btn-primary" id="btnRegistrarChegada" onclick="registrarChegada();"><i class="fa fa-truck"></i><span class="text-btn"> Registrar Chegada</span></a>
        <a class="btn btn-primary hidden" id="btnAlterarChegada" onclick="registrarChegada();"><i class="fa fa-truck"></i><span class="text-btn"> Alterar Chegada</span></a>
        <a class="btn btn-primary hidden" id="btnRegistrarEntrada" onclick="registrarEntrada();"><i class="fa fa-chevron-circle-right"></i><span class="text-btn"> Registrar Entrada</span></a>
        <a class="btn btn-primary hidden" id="btnRegistrarSaida" onclick="registrarSaida();"><i class="fa fa-chevron-circle-left"></i><span class="text-btn"> Registrar Saída</span></a>
        <a class="btn btn-primary" id="btnRelatorio" onclick="relatorioDivergencias();"><i class="fa fa-file-text-o"></i><span class="text-btn"> Relatório</span></a>
        <a class="btn btn-primary" id="btnFechar" data-dismiss="modal"><i class="fa fa-times"></i><span class="text-btn"> Fechar</span></a>
    </div>
</div>




@*<script>

        $(document).ready(function () {
            $("#txtPlaca").mask("aaa-9999");

        });

        $("#txtPasta").keypress(function (e) {
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                return false;
            }
        });

        $("#dttNotas").on("click", ".remover-linha", function () {
            $(this).closest('tr').remove();
        });

        $(".pulaComEnter").keypress(function (e) {
            var tecla = (e.keyCode ? e.keyCode : e.which);
            if (tecla == 13) {
                ConsultarDanfe();
            }
        });

    </script>*@
